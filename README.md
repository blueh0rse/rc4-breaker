# MSCYBER23

## Data Protection

### Lab 1 - RC4 breaker

The goal of this lab was to demonstrate how the RC4 encryption algorithm is vulnerable under certain condition. 

The followed steps are:

1. Environment preparation
   1. Generate a key and a message
   2. Encrypt the message using the concatenation of an incremented IV and the key
   3. Store each ciphertext generated by the encryption process in file along the IV used
2. Attack process
   1. Guess the message
   2. Guess key first byte
   3. Guess key second byte
   4. Guess all key bytes
3. Teacher verification
   1. Guess the message encrypted by the teacher
   2. Guess the key used by the teacher

I used a python script to automate step 1 and 2. And another python script for step 3.

#### Files

Here are the different files needed:

```bash
.
├── readme.pdf
├── main.py
├── prof.py
├── prof_ciphertexts.txt
└── requirements.txt
```

#### How to run?

First you will need to create a python virtual environment:

```bash
python3 -m venv lab_env
```

Then activate the new environment:

```bash
source lab_env/bin/activate
```

Once inside the environment, the requirements must be downloaded:

```bash
(lab_env)$ pip install -r requirements.txt

Successfully installed pycryptodome-3.19.0
```

Now you can run the `main.py` script:

```bash
(lab_env)$ python3 main.py

=== CHANNEL EAVESDROPPING ===
* ORIGINAL VALUES *
[MSG] 0xc9
[KEY] 0xabb2a537cbfdaf585698504747
* GUESSING PART *
[...] Generating all ciphers...
[...] Done!
=== FACT 1 ===
[MSG] Original: 0xc9
[MSG] Guessed : 0xc9, found 34 times
=== FACT 2 ===
[KEY 0] Original: 0xab
[KEY 0] Guessed : 0xab, found 14 times
[KEY 1] Original: 0xb2
[KEY 1] Guessed : 0xb2, found 13 times
=== FACT 3 ===
[KEY 0]: 0xab, found 14 times
[KEY 1]: 0xb2, found 13 times
[KEY 2]: 0xa5, found 20 times
[KEY 3]: 0x37, found 15 times
[KEY 4]: 0xcb, found 7 times
[KEY 5]: 0xfd, found 7 times
[KEY 6]: 0xaf, found 16 times
[KEY 7]: 0x58, found 7 times
[KEY 8]: 0x56, found 6 times
[KEY 9]: 0x98, found 10 times
[KEY 10]: 0x50, found 15 times
[KEY 11]: 0x47, found 13 times
[KEY 12]: 0x47, found 9 times
[KEY] Guessed : 0xabb2a537cbfdaf585698504747
[KEY] Original: 0xabb2a537cbfdaf585698504747
```

It created the `cs.txt` file containing all the ciphertexts.

Now time to run the `prof.py` file:

```bash
(lab_env)$ python3 prof.py

I think the key is: 0xfc4b86fb2027dd61fb6bbf57
I think the msg is: 0xc2, found 40 times
```

### How to clean?

When you finish with the scripts you can just delete the folder you where inside to remove everything. 

Or you can just delete the `lab_env` folder to remove the virtual environment but keep the scripts.
